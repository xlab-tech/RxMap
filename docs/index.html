<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="./">
  <title data-ice="title">Manual | @rxmap/rxmap</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
<meta name="description" content="map command and reactive "><meta property="twitter:card" content="summary"><meta property="twitter:title" content="@rxmap/rxmap"><meta property="twitter:description" content="map command and reactive "><meta property="twitter:image" content="https://avatars0.githubusercontent.com/u/37194013?s=400&amp;u=692377e91a2dab11006abb01d0db33cdb211c9b8&amp;v=4"></head>
<body class="layout-container manual-root manual-index" data-ice="rootContainer">

<header>
  <a href="./" style="display: flex; align-items: center;"><img src="./image/brand_logo.png" style="width:34px;"></a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  <a href="test.html" data-ice="testLink">Test</a>
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
<a style="position:relative; top:3px;" href="https://github.com/xlab-tech/RxMap.git"><img width="20px" src="./image/github.png"></a></header>

<nav class="navigation" data-ice="nav"><div class="manual-toc-root">
  
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/overview.html"><a href="manual/overview.html" data-ice="link">Overview</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/overview.html"><a href="manual/overview.html#ventajas" data-ice="link">Ventajas</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/install.html"><a href="manual/install.html#instalaci&#xF3;n" data-ice="link">Instalaci&#xF3;n</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/install.html"><a href="manual/install.html#npm" data-ice="link">NPM</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/install.html"><a href="manual/install.html#cdn" data-ice="link">CDN</a></li>
<li data-ice="manualNav" class="indent-h1" data-link="manual/install.html"><a href="manual/install.html#como-utilizarla" data-ice="link">Como utilizarla</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/howItWorks.html"><a href="manual/howItWorks.html" data-ice="link">Como funciona</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/howItWorks.html"><a href="manual/howItWorks.html#cargar" data-ice="link">Cargar</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/howItWorks.html"><a href="manual/howItWorks.html#librer&#xED;as" data-ice="link">Librer&#xED;as</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/howItWorks.html"><a href="manual/howItWorks.html#acciones" data-ice="link">Acciones</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/howItWorks.html"><a href="manual/howItWorks.html#observadores" data-ice="link">Observadores</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/howItWorks.html"><a href="manual/howItWorks.html#middlewares" data-ice="link">Middlewares</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/howItWorks.html"><a href="manual/howItWorks.html#observar-acciones" data-ice="link">Observar acciones</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/howItWorks.html"><a href="manual/howItWorks.html#store-observable" data-ice="link">Store Observable</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/make.html"><a href="manual/make.html" data-ice="link">Creaci&#xF3;n</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/make.html"><a href="manual/make.html#como-crear-acciones" data-ice="link">Como crear acciones</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/make.html"><a href="manual/make.html#como-crear-observadores" data-ice="link">Como crear observadores</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/make.html"><a href="manual/make.html#como-crear-un-middleware" data-ice="link">Como crear un middleware</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/make.html"><a href="manual/make.html#como-crear-una-libreria" data-ice="link">Como crear una libreria</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/build.html"><a href="manual/build.html" data-ice="link">Build</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/examples.html"><a href="manual/examples.html" data-ice="link">Ejemplos</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/libs.html"><a href="manual/libs.html" data-ice="link">Librerias</a></li>
</ul>
  </div>
</div>
</nav>

<div class="content" data-ice="content"><div class="github-markdown">
  <div class="manual-user-index" data-ice="manualUserIndex"><h1 id="-a-href--https---xlab-tech---img-src--https---avatars0-githubusercontent-com-u-37194013-s-400-u-692377e91a2dab11006abb01d0db33cdb211c9b8-v-4----height--24----a--rxmap"><a href="https://xlab.tech"><img src="https://avatars0.githubusercontent.com/u/37194013?s=400&amp;u=692377e91a2dab11006abb01d0db33cdb211c9b8&amp;v=4" height="24"></a> RxMap</h1><p><a href="https://travis-ci.org/xlab-tech/RxMap"><img src="https://travis-ci.org/xlab-tech/RxMap.svg?branch=master" alt="Build Status"></a>
<a href="https://www.codacy.com/project/xlab/RxMap/dashboard?utm_source=github.com&amp;utm_medium=referral&amp;utm_content=xlab-tech/RxMap&amp;utm_campaign=Badge_Grade_Dashboard"><img src="https://api.codacy.com/project/badge/Grade/fe06b87e1b6b4e279c8507c82d8ba73f" alt="Codacy Badge"></a>
<a href="https://coveralls.io/github/xlab-tech/RxMap?branch=master"><img src="https://coveralls.io/repos/github/xlab-tech/RxMap/badge.svg?branch=master" alt="Coverage Status"></a>
<a href="https://david-dm.org/xlab-tech/RxMap"><img src="https://david-dm.org/xlab-tech/RxMap/status.svg" alt="dependencies Status"></a>
<a href="https://david-dm.org/xlab-tech/RxMap?type=dev"><img src="https://david-dm.org/xlab-tech/RxMap/dev-status.svg" alt="devDependencies Status"></a>
<a href="https://github.com/airbnb/javascript"><img src="https://img.shields.io/badge/code%20style-airbnb-blue.svg?style=flat-square" alt="Code style: airbnb"></a>
<a href="https://github.com/xlab-tech/RxMap/blob/master/LICENSE"><img src="https://img.shields.io/aur/license/yaourt.svg" alt="AUR"></a></p>
<p><a href="https://xlab.tech"><img src="https://avatars0.githubusercontent.com/u/37194013?s=400&amp;u=692377e91a2dab11006abb01d0db33cdb211c9b8&amp;v=4" height="64"></a>
&#xA0;&#xA0;
<a href="https://join.slack.com/t/xlab-tech/shared_invite/enQtNDIwMzg1MTA2NjA5LTljZWNkZjliNjhhNTc4MTQ0OWVkNTAwMTE0NmU2YTllYTE5YzllZjM2NTQ1ZmNkMDRmMGI0NWE0NGRiZGIxNmE"><img src="https://cdn.icon-icons.com/icons2/923/PNG/512/slack_alt_icon-icons.com_72013.png" height="64"></a></p>
<p>RxMap es una librer&#xED;a de mapas para programaci&#xF3;n funcional y reactiva usando observables(<a href="https://github.com/ReactiveX/rxjs">RxJs</a>) Y que permite f&#xE1;cilmente anidar llamadas asyncronas.</p>
<p>RxMap se basa en dos conceptos acciones y observadores para organizar tu c&#xF3;digo en peque&#xF1;os bloques. Y tambi&#xE9;n te permite escribir middlewares para desacoplar mejor tu c&#xF3;digo.</p>
<p>De facto incluye observables sobre las acciones y un store obsevable, para poder observar  los cambios sobre datos que guardes.</p>
<p>RxMap a&#xF1;ade una capa de abstracci&#xF3;n sobre las librer&#xED;as de mapas, esta dise&#xF1;ada para desacoplarte i evitarte tener que actualizar tu c&#xF3;digo con cada cambio de librer&#xED;as o utilizar una mapa diferente seg&#xFA;n el entorno. Podr&#xE1;s 
centrarte en desarrollar tus funcionalidades.</p>
<p>RxMap te permite cargar el c&#xF3;digo en diferido cuando la utilizas para mejorar los tiempos de carga, es recomendable desplegarlo en http2.</p>
<h2 id="ventajas">Ventajas</h2><ul>
<li>Cargar en diferido de las acciones y los observadores (Lazy Loader).</li>
<li>Trabajar con observadores. (RxJs).</li>
<li>Trabajar de manara asyncrona.</li>
<li>Programaci&#xF3;n funcional.</li>
<li>Store Observable.</li>
<li>Trabaja con multiples mapas, sin cambiar tu c&#xF3;digo.</li>
<li>Reutilizaci&#xF3;n de c&#xF3;digo entre diferentes proyectos.</li>
</ul>
<h2 id="instalaci&#xF3;n">Instalaci&#xF3;n</h2><h3 id="npm">NPM</h3><pre><code><code class="source-code prettyprint">Npm install @rxmap\rxmap &#x2014;save</code>
</code></pre><h3 id="cdn">CDN</h3><pre><code><code class="source-code prettyprint">&lt;head&gt;
&lt;script type=&#x2018;application/javascript&#x2019; src=&#x2018;https://unpkg.com/@rxmap/rxmap@0.1.0&#x2019; defer/&gt;
&lt;/head&gt;
</code>
</code></pre><h2 id="como-utilizarla">Como utilizarla</h2><p>Lo ideal es tener las acciones y los observadores en librer&#xED;as externas, lo primero seria registrar estas librer&#xED;as para poder utilizarlas</p>
<pre><code><code class="source-code prettyprint">import rxLib from &apos;@rxmap/basiclib&apos;;
registerLib(...rxLib);
</code>
</code></pre><p> Una vez registradas las librer&#xED;as o las acciones a utilizar. Lo primero es cargar el mapa que se quiera utilizar 
Y despu&#xE9;s ya se pueden invocar las acciones o observadores a utilizar.</p>
<pre><code><code class="source-code prettyprint">import { RxMap } from &#x2018;@rxmap/rxmap&#x2019;;
await RxMap.load(&#x2018;leaflet&#x2019;);
RxMap.create(&#x2018;mapId&#x2019;,2.45,41.56,10);
RxMap.marker(2.45,41.56).popup(&#x2018;hello&#x2019;);
</code>
</code></pre><p>O  para versi&#xF3;n de CDN.</p>
<pre><code><code class="source-code prettyprint">R.RxMap.load(&#x2018;leaflet&#x2019;);
R.RxMap.create(&#x2018;mapId&#x2019;,2.45,41.56,10);
R.RxMap.marker(2.45,41.56).popup(&#x2018;hello&#x2019;);
</code>
</code></pre><p>La primera acci&#xF3;n que se tiene que invocar debe devolver el mapa inicial inicializado, normalmente esta acci&#xF3;n se llama &#x2018;create&#x2019; y debe ser sincrona, es decir no devolver una promesa. Es recomendable no anidar las llamadas a create, sino volver a hacer llamadas sobre RxMap, como se observa en los ejemplos anteriores.</p>
<h2 id="documentaci&#xF3;n">Documentaci&#xF3;n</h2><p>Puedes encontrar m&#xE1;s Documentaci&#xF3;n aqu&#xED;:</p>
<ul>
<li><a href="https://xlab-tech.github.io/RxMap/manual/overview.html">Overview</a></li>
<li><a href="https://xlab-tech.github.io/RxMap/manual/install.html">Instalar</a></li>
<li><a href="https://xlab-tech.github.io/RxMap/manual/howItWorks.html">Como Utilizar</a><ul>
<li><a href="https://xlab-tech.github.io/RxMap/manual/howItWorks.html#acciones">Acciones</a></li>
<li><a href="https://xlab-tech.github.io/RxMap/manual/howItWorks.html#observadores">Observadores</a></li>
<li><a href="https://xlab-tech.github.io/RxMap/manual/howItWorks.html#librer&#xED;as">Librer&#xED;as</a></li>
<li><a href="https://xlab-tech.github.io/RxMap/manual/howItWorks.html#middlewares">Middlewares</a></li>
<li><a href="https://xlab-tech.github.io/RxMap/manual/howItWorks.html#observar-acciones">Observar acciones</a></li>
<li><a href="https://xlab-tech.github.io/RxMap/manual/howItWorks.html#store-observable">Store</a></li>
</ul>
</li>
<li><a href="https://xlab-tech.github.io/RxMap/manual/make.html">Como crear</a><ul>
<li><a href="https://xlab-tech.github.io/RxMap/manual/make.html#como-crear-acciones">Acciones</a></li>
<li><a href="https://xlab-tech.github.io/RxMap/manual/make.html#como-crear-observadores">Observadores</a></li>
<li><a href="https://xlab-tech.github.io/RxMap/manual/make.html#como-crear-un-middleware">Middlewares</a></li>
<li><a href="https://xlab-tech.github.io/RxMap/manual/make.html#como-crear-una-libreria">Librer&#xED;a</a></li>
</ul>
</li>
<li><a href="https://xlab-tech.github.io/RxMap/manual/build.html">Build</a></li>
</ul>
<h1 id="examples">Examples</h1><h1 id="librerias">Librerias</h1><p>Librer&#xED;as para a&#xF1;adir acciones y observadores:</p>
<ul>
<li><a href="https://github.com/xlab-tech/RxMapBasicLib">RxMapBasicLib</a></li>
<li>.. </li>
</ul>
<p>Para a&#xF1;adir una nueva librer&#xED;a enviar un mail a <a href="mailto:rxmap@xlab.tech">rxmap@xlab.tech</a>  o realiza un pullRequest de la documentaci&#xF3;n con la libreria a&#xF1;adida.
Para hacer un PullRequest:</p>
<ul>
<li>Haz un fork del repositorio.</li>
<li>Haz commit y push de los cambios en tu reposition.</li>
<li>Crear un PullRequest . </li>
</ul>
</div>

  

  <div class="manual-cards">
    
  <div class="manual-card-wrap" data-ice="cards">
      <div class="manual-card">
        <div data-ice="card"><h1>Overview</h1><p>RxMap es una librer&#xED;a de mapas para programaci&#xF3;n funcional y reactiva usando observables(<a href="https://github.com/ReactiveX/rxjs">RxJs</a>) Y que permite f&#xE1;cilmente anidar llamadas asyncronas.</p><p>RxMap se basa en dos conceptos acciones y observadores para organizar tu c&#xF3;digo en peque&#xF1;os bloques. Y tambi&#xE9;n te permite escribir middlewares para desacoplar mejor tu c&#xF3;digo.</p><p>De facto incluye observables sobre las acciones y un store obsevable, para poder observar  los cambios sobre datos que guardes.</p><p>RxMap a&#xF1;ade una capa de abstracci&#xF3;n sobre las librer&#xED;as de mapas, esta dise&#xF1;ada para desacoplarte i evitarte tener que actualizar tu c&#xF3;digo con cada cambio de librer&#xED;as o utilizar una mapa diferente seg&#xFA;n el entorno. Podr&#xE1;s 
centrarte en desarrollar tus funcionalidades.</p><p>RxMap te permite cargar el c&#xF3;digo en diferido cuando la utilizas para mejorar los tiempos de carga, es recomendable desplegarlo en http2.</p><h2>Ventajas</h2><ul>
<li>Cargar en diferido de las acciones y los observadores (Lazy Loader).</li>
<li>Trabajar con observadores. (RxJs).</li>
<li>Trabajar de manara asyncrona.</li>
<li>Programaci&#xF3;n funcional.</li>
<li>Store Observable.</li>
<li>Trabaja con multiples mapas, sin cambiar tu c&#xF3;digo.</li>
<li>Reutilizaci&#xF3;n de c&#xF3;digo entre diferentes proyectos.</li>
</ul></div>
        <a data-ice="link" href="manual/overview.html"></a>
      </div>
    </div>
<div class="manual-card-wrap" data-ice="cards">
      <div class="manual-card">
        <div data-ice="card"><h1>Como utilizarla</h1><pre><code><code class="source-code prettyprint">import { RxMap } from &#x2018;@rxmap/rxmap&#x2019;;
await RxMap.load(&#x2018;leaflet&#x2019;);
RxMap.create(&#x2018;mapId&#x2019;,2.45,41.56,10);
RxMap.marker(2.45,41.56).popup(&#x2018;hello&#x2019;);
</code>
</code></pre><p>O  para versi&#xF3;n de CDN.</p><pre><code><code class="source-code prettyprint">R.RxMap.load(&#x2018;leaflet&#x2019;);
R.RxMap.create(&#x2018;mapId&#x2019;,2.45,41.56,10);
R.RxMap.marker(2.45,41.56).popup(&#x2018;hello&#x2019;);
</code>
</code></pre><p>La primera acci&#xF3;n que se tiene que invocar debe devolver el mapa inicial inicializado, normalmente esta acci&#xF3;n se llama &#x2018;create&#x2019; y debe ser sincrona, es decir no devolver una promesa. Es recomendable no anidar las llamadas a create, sino volver a hacer llamadas sobre RxMap, como se observa en los ejemplos anteriores.</p></div>
        <a data-ice="link" href="manual/install.html#como-utilizarla"></a>
      </div>
    </div>
<div class="manual-card-wrap" data-ice="cards">
      <div class="manual-card">
        <div data-ice="card"><h1>Como funciona</h1><h2>Cargar</h2><p>Para empezar a utilizar la librer&#xED;a lo primero es cargar el mapa que se quiere utilizar para ello se puede hacer de dos maneras. Directamente con el m&#xE9;todo load o con loadConfig los dos son m&#xE9;todos as&#xED;ncronos que puedes usar con await o con formato promesa.</p><pre><code><code class="source-code prettyprint">import { RxMap } from &apos;@rxmap/rxmap&apos;;
const config = {};
await RxMap.load(&#x2018;leaflet&#x2019;,config);</code>
</code></pre><pre><code><code class="source-code prettyprint">import { RxMap } from &apos;@rxmap/rxmap&apos;;
const config = {};
RxMap.load(&#x2018;leaflet&#x2019;,config).then((map)=&gt;{
   // execute actions
});
</code>
</code></pre><p>O </p><pre><code><code class="source-code prettyprint">import { RxMapFromConfig } from &apos;@rxmap/rxmap&apos;;

const config = {
  type: &apos;leaflet&apos;,
  options: {
    key: &apos;&apos;,
  },
  map: {
    autoCenter: false,
    center: {
      lat: 51.505,
      lng: -0.09,
    },
    zoom: 13,
  },
};


const map = await RxMapFromConfig(config);

</code>
</code></pre><h2>Librer&#xED;as</h2><p>Para utilizar las acciones y los observadores tienes que cargar las librer&#xED;as que quieras de acciones y observadores,  propias o de terceros. Al cargar las librer&#xED;as ya tienes disponibles todas las acciones que incorporen estas librer&#xED;as en RxMap o en los observadores, (&#x2018;una vez los recuperas desde RxMap&#x2019; &lt; <code>rxMap.observer(from(5))</code>&gt;). Pero al tener carga din&#xE1;mica no bajas el c&#xF3;digo de todas las acciones, reduciendo el tiempo de carga, sino que se cargara el c&#xF3;digo de cada acci&#xF3;n o observador cuando la utilices. ( lazy Loader) </p><p>La funci&#xF3;n registerLib, espera como par&#xE1;metros el nombre de la librer&#xED;a, un objeto con los nombre de acciones y con los nombre de los observadores a cargar de esa libreria, y la funci&#xF3;n para la carga dynamica de las acciones y observadores</p><pre><code><code class="source-code prettyprint">import { registerLib } from &apos;@rxmap/rxmap&apos;;

registerLib(&#x2018;test&#x2019;,{
    observers:[&#x2018;test&#x2019;],
    actions:[&#x2018;example&#x2019;]
},
(type, mapLib, version, key) =&gt; import(/* webpackMode: &quot;lazy&quot; */ `./${type}/${mapLib}@${version}/${key}`);
);
</code>
</code></pre><p>Idealmente las librer&#xED;as incluyen en default un array con los par&#xE1;metros ya preparados.</p><pre><code><code class="source-code prettyprint">import { registerLib } from &apos;@rxmap/rxmap&apos;;
import rxLib from &apos;@rxmap/rxmap/lib&apos;;

registerLib(...rxLib);</code>
</code></pre><p>Otra forma de tener acciones o observadores es registr&#xE1;ndolos para poder utilizarlos,pero de esta forma no tendr&#xE1;s la carga dynamica I tendr&#xE1;s que gestionar ,qual cargas seg&#xFA;n la librer&#xED;a de mapas que estes utilizando. Al contrario las librer&#xED;as gestionan esto de manera autom&#xE1;tica. 
Consulta la librer&#xED;a que utilizas para saber que mapas soporta. </p><h2>Acciones</h2><p>Las acciones son funciones &#x201C;puras&#x201D; que realizan acciones sobre el mapa, la idea es que solo realicen una &#xFA;nica acci&#xF3;n para que sean mucho m&#xE1;s f&#xE1;ciles de reaprovechar , probar y debugar.
Las acciones se pueden invocar sobre RxMap o sobre un observador. Las acciones se pueden anidar entre ellas. Cada invocaci&#xF3;n de acciones es  as&#xED;ncrona pero dentro de cada secuencia en s&#xED;ncrona. Cada acci&#xF3;n recibe el valor de la acci&#xF3;n anterior para poder concatenar acciones.</p><pre><code><code class="source-code prettyprint">RxMap.test();

RxMap.test2().test();

RxMap.observer(from(1)).test();
</code>
</code></pre><h2>Observadores</h2><p>Los observadores son funciones que devuelven un observador ( RxJs )  para por ejemplo , gestionar los eventos del mapa como puede ser el click, o para gestionar datos que se pueden recibir continuamente como la posici&#xF3;n GPS, el centro del mapa, etc...
Con los observadores se pueden utilizar todos los operadores de RxJs para modificar, transformar , etc.. los valores del observador.</p><p>Tambi&#xE9;n se pueden utilizar observadores creados con RxJs para utilizar las acciones de RxMap. 
Cuando  se utiliza un observador, se puede pasar como par&#xE1;metro a la acci&#xF3;n una funci&#xF3;n que transforme los argumentos en un array con los argumentos que espera la acci&#xF3;n.</p><pre><code><code class="source-code prettyprint">RxMap.observer(&#x2018;&lt;observer name&gt;&#x2019;).subscribe((data) =&gt; console.log);

RxMap.observer(&#x2018;gps&#x2019;).pipe(take(2)).subscribe(data=&gt;console.log(data));

RxMap.observer(from([{lat:1,lng:2},{lat:2,lng:3}]).marker(data=&gt;([data.lat,data.lng])).subscribe()

</code>
</code></pre><h2>Middlewares</h2><p>RxMap tambi&#xE9;n te permite usar middlewares, para realizar acciones como:</p><pre><code><code class="source-code prettyprint">* Logger de las funciones
* Realizar acciones antes o despu&#xE9;s de la ejecuci&#xF3;n de las acciones.
* Aplicar transformaciones
* Etc...</code>
</code></pre><p>Un middleware lo puedes aplicar sobre todas las acciones o sobre una acci&#xF3;n en concreto.
Si al registrar el middleware el primer par&#xE1;metro es un string, s&#xF3;lo se aplicar&#xE1; a la acci&#xF3;n con ese nombre. Si el primer par&#xE1;metro es el middleware se aplicar&#xE1; a todas las acciones.</p><p>Se pueden aplicar todos los middleware que se deseen.</p><pre><code><code class="source-code prettyprint">
registerMiddleware(LoggerMiddleware);

O

registerMiddleware(&apos;marker&apos;, TimerMiddleware);
</code>
</code></pre><h2>Observar acciones</h2><p>Con RxMap  puedes observar las acciones para poder saber cuando se llama una acci&#xF3;n concreta  o un grupo de acciones con una expresi&#xF3;n RegEx y realizar otra operaci&#xF3;n.</p><pre><code><code class="source-code prettyprint">
RxMap.observerAction(&apos;marker&apos;).subscribe((data) =&gt; {
    console.log(&quot;Action Subscriber 1 got data &gt;&gt;&gt;&gt;&gt; &quot;, data);
  });


RxMap.observerAction(&apos;.&apos;).subscribe((data) =&gt; {
    console.log(&quot;Action Subscriber 2 got data &gt;&gt;&gt;&gt;&gt; &quot;, data);
  });
</code>
</code></pre><h2>Store Observable</h2><p>RxMap dispone de un store que  te permite guardar informaci&#xF3;n y observarla para realizar acciones cuando esta informaci&#xF3;n se modifique.</p><pre><code><code class="source-code prettyprint">RxMap.observerStore(&#x2018;test&#x2019;).subscribe((data) =&gt; {
    console.log(&quot;Store Subscriber 1 got data &gt;&gt;&gt;&gt;&gt; &quot;, data);
  });

RxMap.observerStore(&#x2018;.&#x2019;).subscribe((data) =&gt; {
    console.log(&quot;Store Subscriber 2 got data &gt;&gt;&gt;&gt;&gt; &quot;, data);
  });

RxMap.store.test = &#x2018;example&#x2019;;

RxMap.store.example = 5;

const t = RxMap.store.test;

</code>
</code></pre><p>Con estas opciones te permite generar un c&#xF3;digo mucho m&#xE1;s desacoplado de la librer&#xED;a de mapas que quieras utilizar y de esas forma tu c&#xF3;digo tendr&#xE1; una vida mucho m&#xE1;s larga, pudiendo actualizar cada versi&#xF3;n de la librer&#xED;a o cambiando de ella con un esfuerzo mucho menor.</p></div>
        <a data-ice="link" href="manual/howItWorks.html"></a>
      </div>
    </div>
<div class="manual-card-wrap" data-ice="cards">
      <div class="manual-card">
        <div data-ice="card"><h1>Creaci&#xF3;n</h1><h2>Como crear acciones</h2><p>Una acci&#xF3;n es una funci&#xF3;n que recibe unos par&#xE1;metros y devuelve el resultado o una promesa, puede ser una funci&#xF3;n async. Los objetivos de las acciones son interaccionar con el mapa. 
Es recomendable que s&#xF3;lo utilicen un m&#xE9;todo o propiedad  sobre el mapa para que sea m&#xE1;s f&#xE1;cil el desacoplarse.
Se pueden crear acciones que llamen a otras acciones.</p><p>Las acciones deben tener el m&#xED;nimo posible de dependencias.
Es recomendable que cada acci&#xF3;n se ubicaque en un fichero.
Las acciones se tienen que exportar como default  y se tiene que exportar la propiedad &#x201C;name&#x201D; con el nombre de la acci&#xF3;n. Este nombre ser&#xE1; el nombre con en el que se registre y se utilizar&#xE1; para invocarla desde RxMap o desde los observadores.</p><p>A todas las acciones se les inyecta como primer par&#xE1;metro el contexto que es un objeto que incluye:</p><pre><code><code class="source-code prettyprint">*  RxMap
* La librer&#xED;a Nativa del Mapa
* El valor de la anterior acci&#xF3;n
* El store</code>
</code></pre><p>Un ejemplo de acci&#xF3;n ser&#xED;a.</p><pre><code><code class="source-code prettyprint"> const setCenter = (context, paramA, paramB) =&gt; {
       const map = context.source.getMap();
         const oldCenter = map.getCenter();
         map.setCenter(paramA,paramB);
         return map;
};

export default setCenter;
</code>
</code></pre><p>Para poder utilizar esta acci&#xF3;n hay dos formas. La puedes registrar manualmente o tenerla en una libreria y registrar la libreria.</p><p>Para registrar manualmente una acci&#xF3;n se tendr&#xED;a que hacer lo siguiente.</p><pre><code><code class="source-code prettyprint">import { registerAction, RxMap } from &#x2018;@rxmap/rxmap&#x2019;;
import { name }, action from &#x2018;./actionExample&#x2019;;

registerAction(name,action);

RxMap.load(&#x2018;leaflet&#x2019;);
RxMap.create(&#x2018;mapId&#x2019;,0,0,8);
// aqu&#xED; ya podr&#xED;amos utilizar la acci&#xF3;n 
RxMap.setCenter(2.35,42.112);
</code>
</code></pre><p>Si registramos las acciones no estaremos utilizando la capacidad de cargar el c&#xF3;digo de manera dynamica. Sino que se incluir&#xE1;n en el bundle principal de la aplicaci&#xF3;n.</p><h2>Como crear observadores</h2><p>Un observador es una funci&#xF3;n que puede o no recibir par&#xE1;metros y que devuelve siempre un observador <a href="https://rxjs-dev.firebaseapp.com">RxJS</a></p><p>La idea de los observadores es reemplazar los eventos para poder tener m&#xE1;s control sobre las cosas que pasan sobre el mapa. Y poder encadenar de manera mucho m&#xE1;s simple acciones a partir de cosas que pasen.
Con los observadores se pueden utilizar todos los transformadores y operadores de RxJS.</p><p>Los observadores deben tener el m&#xED;nimo posible de dependencias.
Es recomendable que cada observador se ubicaque en un fichero.
Los observadores se tienen que exportar como default  y se tiene que exportar la propiedad &#x201C;name&#x201D; con el nombre del observador. Este nombre ser&#xE1; el nombre con en el que se registre y ser&#xE1; el nombre con el que se recuperar el observador.</p><p>A todos los observadores se les inyecta como primer par&#xE1;metro el contexto que es un objeto que incluye:</p><pre><code><code class="source-code prettyprint">*  RxMap
* La librer&#xED;a Nativa del Mapa
* El valor de la anterior acci&#xF3;n
* El store</code>
</code></pre><p>Un ejemplo de observador podr&#xED;a ser:</p><pre><code><code class="source-code prettyprint">import { fromEventPattern } from &apos;rxjs/internal/observable/fromEventPattern&apos;;
import { map } from &apos;rxjs/internal/operators/map&apos;;

const event = (context) =&gt; {
  const googleMaps = context.library.maps;
  const map_ = context.source.getMap();

  const addClickHandler = handler =&gt; map_.addListener(&apos;center_changed&apos;, handler);
  const removeClickHandler = (handler, listener) =&gt; googleMaps.event.removeListener(listener);


  return fromEventPattern(
    addClickHandler,
    removeClickHandler,
  ).pipe(map(() =&gt; {
    const center = map_.getCenter();
    return { lat: center.lat(), lng: center.lng() };
  }));
};

export default event;
/**
 * @private
*/
export const name = &apos;center&apos;;
</code>
</code></pre><p>Para poder utilizar este observador  hay dos formas. La puedes registrar manualmente o tenerlo en una libreria y registrar la libreria.</p><p>Para registrar manualmente el observador se tendr&#xED;a que hacer lo siguiente.</p><pre><code><code class="source-code prettyprint">import { registerObserver, RxMap } from &#x2018;@rxmap/rxmap&#x2019;;
import { name }, observer from &#x2018;./observerExample&#x2019;;

registerObserver(name,observer);

RxMap.load(&#x2018;leaflet&#x2019;);
RxMap.create(&#x2018;mapId&#x2019;,0,0,8);
// aqu&#xED; ya podr&#xED;amos utilizar la acci&#xF3;n 
RxMap.observer(&#x2018;center&#x2019;).subscribe((data)=&gt;{
   console.log(data);
});
</code>
</code></pre><p>Si registramos los observadores manualmente  no estaremos utilizando la capacidad de cargar el c&#xF3;digo de manera dynamica. Sino que se incluir&#xE1;n en el bundle principal de la aplicaci&#xF3;n.</p><h2>Como crear un middleware</h2><p>Los middleware son funciones que devuelve una funci&#xF3;n, El middleware recibe como par&#xE1;metro la siguiente acci&#xF3;n a ejecutar y la funci&#xF3;n que devuelve debe ser as&#xED;ncrona y recibe como par&#xE1;metros el CommandBus que esta realizando la ejecuci&#xF3;n y los argumentos de la funci&#xF3;n en un array. La funci&#xF3;n debe devolver el resultado de la ejecuci&#xF3;n de la acci&#xF3;n.</p><p>Desde el CommandBus se puede recuperar el contexto con getContext() y el nombre de la funci&#xF3;n que esta ejecutando con getActionName().</p><p>En el middleware puedes hacer aciones antes de llamar a la acci&#xF3;n a ejecutar. Y puedes modificar o hacer acciones despu&#xE9;s de ejecutar la acci&#xF3;n.</p><p>Un ejemplo de middleware podr&#xED;a ser el logger de las acciones:</p><pre><code><code class="source-code prettyprint">
export const LoggerMiddleware = next =&gt; async (CommandBus, args) =&gt; {
  const actionName = commandBus.getActionName();
  const now = new Date().getTime();
  const name = `Command ${actionName} [${now}]: `;
  console.log(`Pre ${name}`, args);
  const res = await next(Map, args);
  console.log(`Post ${name}`, res);
  return res;
};</code>
</code></pre><p>Los middleware se tienen no se cargan din&#xE1;micamente se tienen que importar espec&#xED;ficamente.</p><h2>Como crear una libreria</h2><p>Las librer&#xED;as se pueden crear dentro de tu proyecto o como un proyecto independiente para poder reaprovecharlas en otros proyectos.</p><p>Las librer&#xED;as son un conjunto de acciones y observadores que ofrecen la misma funcionalidad sobre uno o diferentes mapas.</p><p>Idealmente tienen la siguiente estructura</p><p>&lt;libName&gt;<em>&lt;type&gt;</em>&lt;mapType&gt;:&lt;version&gt;/&lt;actionName&gt;</p><p>Example: lib_actions_google@latest_setCenter.js o lib_observer_google@latest_center.js</p><p>En las librer&#xED;as cada acci&#xF3;n o observador debe estar en un &#xFA;nico fichero y cada fichero debe exponer en default la acci&#xF3;n y debe exponer la propiedad name con el nombre de la acci&#xF3;n</p><p>Las librer&#xED;as tienen que tener un fichero index.js que incluya  lo siguiente:</p><pre><code><code class="source-code prettyprint">* la funci&#xF3;n de carga dynamica de sus acciones y observadores. Esta funci&#xF3;n recibir&#xE1; como par&#xE1;metros el tipo [observer|action] , el nombre de la libreria de mapas, la versi&#xF3;n ( latest por defecto) y la clave o nombre de la acci&#xF3;n o el observador. Se recomienda que se llame  &#x2018;func&#x2019;.</code>
</code></pre><pre><code><code class="source-code prettyprint">const func = (type, mapLib, version, key) =&gt; import(/* webpackMode: &quot;lazy&quot; */ `./${type}/${mapLib}@${version}/${key}`);
</code>
</code></pre><pre><code><code class="source-code prettyprint">* Array con el nombre de los observadores. Se recomienda que se llame  &#x2018;observers&#x2019;
* Array con el nombre de las acciones. Se recomienda que se llame  &#x2018;actions&#x2019;
* El nombre de la librer&#xED;a. Se recomienda que se llame  &#x2018;name&#x2019;.</code>
</code></pre><p>Y es recomendable devolver en el par&#xE1;metro por defecto un array con los datos en el orden que pide la funci&#xF3;n de registrar libreria.</p><p>Adjunto un ejemplo del fichero index.js</p><pre><code><code class="source-code prettyprint">
export const name = &apos;rxmap&apos;;
export const actions = [&apos;addData&apos;, &apos;create&apos;, &apos;marker&apos;, &apos;point&apos;, &apos;popup&apos;, &apos;setCenter&apos;];
export const observers = [&apos;gps&apos;, &apos;center&apos;, &apos;click&apos;];
export const func = (type, mapLib, version, key) =&gt; import(/* webpackMode: &quot;lazy&quot; */ `./${type}/${mapLib}@${version}/${key}`);

export default [
  name,
  {
    observers,
    actions,
  },
  func,
];
</code>
</code></pre><p>Cuando se compila las librer&#xED;as tienen que inlcuir la version con M&#xF3;dulos ( Es2015 ) y la version UMD, en la versi&#xF3;n UMD que suele ser la que se p&#xFA;blica en servicios como unpkg la ruta de la carga de librer&#xED;as din&#xE1;micas deber ser con la url completa no relativa.</p></div>
        <a data-ice="link" href="manual/make.html"></a>
      </div>
    </div>
<div class="manual-card-wrap" data-ice="cards">
      <div class="manual-card">
        <div data-ice="card"><h1>Build</h1><p>Para poder realizar la construcci&#xF3;n del bundle de manera correcta, se necesita utilizar webPack por desgracia actualmente ni Rollup ni Parcel funciona correctamente con los imports din&#xE1;micos, esperamos que esto cambien en breve.</p><p>Para realizar el build con Angular, si queremos disponer de la carga dinamica, hay que modificar los siguientes par&#xE1;metros.</p><pre><code><code class="source-code prettyprint">* En el fichero tsconfig.app.json hay que poner el valor &#x2018;module&#x2019; a &#x2018;esnext&#x2019;</code>
</code></pre></div>
        <a data-ice="link" href="manual/build.html"></a>
      </div>
    </div>
<div class="manual-card-wrap" data-ice="cards">
      <div class="manual-card">
        <div data-ice="card"><h1>Ejemplos</h1><p>Lista de ejemplos disponibles en github.</p></div>
        <a data-ice="link" href="manual/examples.html"></a>
      </div>
    </div>
<div class="manual-card-wrap" data-ice="cards">
      <div class="manual-card">
        <div data-ice="card"><h1>Librerias</h1><p>Librer&#xED;as para a&#xF1;adir acciones y observadores:</p><ul>
<li><a href="https://github.com/xlab-tech/RxMapBasicLib">RxMapBasicLib</a><ul>
<li>.. </li>
</ul>
</li>
</ul><p>Para a&#xF1;adir una nueva librer&#xED;a enviar un mail a <a href="./manual/mailto:rxmap@xlab.tech">rxmap@xlab.tech</a>  o realiza un pullRequest de la documentaci&#xF3;n con la libreria a&#xF1;adida.
Para hacer un PullRequest:</p><ul>
<li>Haz un fork del repositorio.<ul>
<li>Haz commit y push de los cambios en tu reposition.</li>
<li>Crear un PullRequest . </li>
</ul>
</li>
</ul></div>
        <a data-ice="link" href="manual/libs.html"></a>
      </div>
    </div>
</div>
</div>
</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(1.1.0)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
